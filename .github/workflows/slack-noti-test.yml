name: merge-noti-slack

on: 
  push:
    branches: [main]
  
jobs:
  echo:
    runs-on: ubuntu-latest
    steps:
      - run: echo 'Hello, GitHub Actions!'

  slack-notification:
    runs-on: ubuntu-latest
    steps:
      - name: ì˜ˆì•½ ì „ì†¡ ì‹œê°„ ê³„ì‚° (1ë¶„ í›„)
        id: calc_time
        run: echo "POST_AT=$(($(date +%s) + 60))" >> $GITHUB_ENV

      - name: Slack ì˜ˆì•½ ë©”ì‹œì§€ ì „ì†¡
        uses: slackapi/slack-github-action@v2.0.0
        with:
          method: chat.scheduleMessage  # âœ… ì˜ˆì•½ ì „ì†¡ APIë¡œ ë³€ê²½
          token: ${{ secrets.SLACK_BOT_TOKEN }}
          payload: >
            {
              "channel": "${{ secrets.SLACK_CHANNEL_ID }}",
              "post_at": ${{ env.POST_AT }},
              "text": "simple test",
              "blocks": [
                {
                  "type": "section",
                  "text": {
                    "type": "mrkdwn",
                    "text": "ğŸš€ *ë°°í¬ ì™„ë£Œ & ëª¨ë‹ˆí„°ë§ ì§„í–‰ ì™„ë£Œ!*"
                  }
                },
                {
                  "type": "section",
                  "text": {
                    "type": "mrkdwn",
                    "text": "ë°°í¬ ë¸Œëœì¹˜ `${{ github.ref }}`ì˜ ë°°í¬ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìœ¼ë©°, *1~2ì‹œê°„ ëª¨ë‹ˆí„°ë§*ë„ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ğŸ‰\n\ní•´ë‹¹ ë¸Œëœì¹˜ë¥¼ `main`ì— ë¨¸ì§€í•´ì£¼ì„¸ìš”!"
                  }
                },
                {
                  "type": "actions",
                  "elements": [
                    {
                      "type": "button",
                      "text": {
                        "type": "plain_text",
                        "text": "ğŸ”— PR ë³´ê¸° & ë¨¸ì§€í•˜ê¸°",
                        "emoji": true
                      },
                      "url": "https://github.com/yurim405/dobby-is-free",
                      "style": "primary"
                    }
                  ]
                },
              ]
            }
